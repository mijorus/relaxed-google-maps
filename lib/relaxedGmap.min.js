/*!
 * relaxedMap: Lazy load Google Maps with cookie consent placeholder
 * (c) 2020 mijorus, MIT License
 */
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function setAttributes(e,t){for(var a in e)t.setAttribute(a,e[a])}function inViewport(e){return e.getBoundingClientRect().top<=(window.innerHeight||document.documentElement.clientHeight)}function checkData(e,t,a){return void 0!==e||void 0!==t.dataset&&void 0!==t.dataset["".concat(a)]?e||t.dataset["".concat(a)]:void 0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var RelaxedMap=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"gmap",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{src:"",alt:"",defaultMapStyle:!1,placeholder:{text:void 0,subtitle:void 0,backgroundImage:void 0,backgroundColor:void 0,blurred:3,grayscale:!0}};return _classCallCheck(this,e),this.relaxedGMap=document.getElementById(t),this.config=a,this.relaxedGMap.classList.add("relaxed-map"),this.iframe,this.relaxedGMap.querySelector("iframe")?this.iframe=this.relaxedGMap.querySelector("iframe"):this.createIframe(),this}return _createClass(e,[{key:"createIframe",value:function(){var e={allowfullscreen:"false","aria-hidden":"false",tabindex:"0",style:this.config.defaultMapStyle?"width: 600px; height: 450px; frameborder: 0; border:0;":"",class:"relaxed-map-iframe"};this.iframe=document.createElement("iframe");var t=document.createElement("div");t.classList.add("relaxed-map-container"),t.style="overflow: hidden",t.appendChild(this.iframe),setAttributes(e,this.iframe),this.relaxedGMap.appendChild(t)}},{key:"unloaded",value:function(){this.relaxedGMap.style.position="relative";var e={target:"_blank",rel:"noopener",style:"width: 100%; height: 100%; position: absolute; top: 0; display: flex; z-index: 50; justify-content: center; align-items: center; cursor: pointer;",class:"relaxed-map-alt"},t=document.createElement("a"),a=checkData(this.config.alt,this.relaxedGMap,"alt"),i=this.config.placeholder||null;if(a){if(t.setAttribute("href",a),i&&i.text){var r=checkData(i.text,this.relaxedGMap,"text");t.innerText=r}else{t.innerText="Open in Google Maps"}setAttributes(e,t),this.relaxedGMap.appendChild(t)}else console.warn("Warning: alternative map link not set");if(i&&i.backgroundImage){var l='background-image: url("'.concat(this.config.placeholder.backgroundImage,'"); background-position: center;');this.iframe.style=l,void 0===i.blurred?this.iframe.style.filter="blur(3px)":this.iframe.style.filter="blur(".concat(i.blurred,"px)"),void 0!==i.grayscale&&!0!==i.grayscale||(this.iframe.style.filter+="grayscale(1)")}else i&&i.backgroundColor?this.iframe.style.backgroundColor=this.config.placeholder.backgroundColor:this.iframe.style.backgroundColor="#e9ecef";this.subtitle=document.createElement("div");if(setAttributes({style:"text-align: center;",class:"relaxed-map-subtitle"},this.subtitle),i&&i.subtitle)this.subtitle.innerText=this.config.placeholder.subtitle;else{this.subtitle.innerText="Please, accept the cookie policy to use the map"}return this.relaxedGMap.appendChild(this.subtitle),this}},{key:"load",value:function(){var e=this;function t(){if(inViewport(e.relaxedGMap)){document.removeEventListener("scroll",t,{passive:!0});var a=e.relaxedGMap.querySelector(".relaxed-map-alt");a&&a.remove(),e.subtitle&&e.subtitle.remove(),e.iframe.style.backgroundImage="",e.iframe.style.filter="",e.iframe.setAttribute("src",e.src);var i=new Event("relaxedMapLoad");e.relaxedGMap.dispatchEvent(i)}}this.src=checkData(this.config.src,this.relaxedGMap,"src"),this.src?inViewport(this.relaxedGMap)?t():document.addEventListener("scroll",t,{passive:!0}):console.warn("Warning: map position not set.")}}]),e}(),_default=RelaxedMap;exports.default=_default;